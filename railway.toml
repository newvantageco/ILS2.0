# Railway Configuration for ILS 2.0 Main Application
# This service runs the Node.js Express backend + React frontend

[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

[deploy]
numReplicas = 1
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Health check configuration
# Using /health (not /api/health) because it's registered before any middleware
# and will always respond with 200 OK regardless of database or other service status
healthcheckPath = "/health"
healthcheckTimeout = 120

# NOTE: startCommand is intentionally omitted to use Dockerfile CMD
# The Dockerfile runs docker-start.sh which handles:
# 1. Database migrations (drizzle-kit migrate - runs pre-generated migrations)
# 2. Application startup (node dist/index.js)

# Resource allocation
# Railway will auto-scale based on usage
# Recommended minimum for production: 2GB RAM, 2 vCPU
