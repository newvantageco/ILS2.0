import{r as S,e}from"./vendor-react-yzYIzJFU.js";import{c as A,u as y,a as p}from"./vendor-react-query-Dxpktacb.js";import{e as M,K as P,f as l,a9 as q,p as K,d as Q,ak as $,J as G,q as z,r as H,t as J,C as D,h as v,i as C,j as k,a as E,B as j,_ as L,I as U}from"./index-BiBisH8X.js";import{L as f}from"./label-DDyL8AZL.js";import{S as Y}from"./switch-BaWOF0DH.js";import{A as W,b as X}from"./alert-DQClezAk.js";import{R as Z}from"./refresh-cw-C3bXnO94.js";import{U as ee}from"./upload-8AnGHi14.js";import{G as se}from"./globe-BMMFt3BO.js";import{S as ae}from"./stethoscope-CP5o09KA.js";import{P as ie}from"./palette-CXD4BRLU.js";import{S as ne}from"./save-IQad8R1X.js";import{R as te}from"./rotate-ccw-CM-YKsm0.js";import{L as re}from"./lock-ykft9mcf.js";import{H as I}from"./history-CFRHx3vb.js";import"./vendor-mui-DFe-F-Gn.js";import"./vendor-radix-B6etWzp2.js";const V=[{name:"system",icon:P,description:"Core system settings and general configuration",settings:["system.name","system.timezone","system.maintenance_mode"]},{name:"security",icon:Q,description:"Security policies, authentication, and access control",settings:["security.session_timeout","security.password_min_length","security.mfa_enabled","security.max_login_attempts"]},{name:"integration",icon:se,description:"External system integrations and APIs",settings:["integration.fhir_enabled","integration.hl7_enabled"]},{name:"communication",icon:$,description:"Email, SMS, and notification settings",settings:["communication.email_enabled","communication.sms_enabled","communication.smtp_host","communication.smtp_password"]},{name:"billing",icon:G,description:"Billing, payments, and financial settings",settings:["billing.currency","billing.tax_rate"]},{name:"clinical",icon:ae,description:"Clinical workflows and medical settings",settings:["clinical.appointment_duration_default","clinical.prescription_refill_days"]},{name:"ui",icon:ie,description:"User interface and display preferences",settings:["ui.theme","ui.items_per_page"]}];function Ce(){const{toast:r}=M(),o=A(),[t,c]=S.useState({}),[N,w]=S.useState("system"),{data:u,isLoading:_}=y({queryKey:["/api/system-admin/config/settings"]}),{data:d}=y({queryKey:["/api/system-admin/config/history"]}),b=p({mutationFn:async({key:s,value:a})=>{const i=await fetch(`/api/system-admin/config/settings/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({value:a})});if(!i.ok)throw new Error("Failed to update setting");return i.json()},onSuccess:(s,a)=>{r({title:"Setting Updated",description:`${a.key} has been updated successfully.`}),o.invalidateQueries({queryKey:["/api/system-admin/config/settings"]}),o.invalidateQueries({queryKey:["/api/system-admin/config/history"]}),c(i=>{const n={...i};return delete n[a.key],n})},onError:s=>{r({title:"Error",description:s.message,variant:"destructive"})}}),h=p({mutationFn:async s=>{const a=await fetch(`/api/system-admin/config/settings/${s}/reset`,{method:"POST",credentials:"include"});if(!a.ok)throw new Error("Failed to reset setting");return a.json()},onSuccess:(s,a)=>{r({title:"Setting Reset",description:`${a} has been reset to default value.`}),o.invalidateQueries({queryKey:["/api/system-admin/config/settings"]}),c(i=>{const n={...i};return delete n[a],n})},onError:s=>{r({title:"Error",description:s.message,variant:"destructive"})}}),x=p({mutationFn:async()=>{const s=await fetch("/api/system-admin/config/export",{credentials:"include"});if(!s.ok)throw new Error("Failed to export configuration");return s.json()},onSuccess:s=>{const a=new Blob([s.config],{type:"application/json"}),i=URL.createObjectURL(a),n=document.createElement("a");n.href=i,n.download=`ils-config-${new Date().toISOString()}.json`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i),r({title:"Configuration Exported",description:"Configuration has been downloaded successfully."})}}),g=(s,a)=>{c(i=>({...i,[s]:a}))},T=s=>{const a=t[s];a!==void 0&&b.mutate({key:s,value:a})},R=s=>{h.mutate(s)},F=s=>{if(t[s]!==void 0)return t[s];const a=u?.settings.find(i=>i.key===s);return a?.value||a?.defaultValue||""},m=s=>{const a=u?.settings.find(i=>i.key===s);return t[s]!==void 0&&t[s]!==(a?.value||"")},B=s=>{const a=F(s.key);return m(s.key),s.dataType==="boolean"?e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV(f,{htmlFor:s.key,children:s.key},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:264,columnNumber:13},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground mt-1",children:s.description},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:265,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:263,columnNumber:11},this),e.jsxDEV(Y,{id:s.key,checked:a==="true",onCheckedChange:i=>g(s.key,String(i))},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:267,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:262,columnNumber:9},this):s.dataType==="number"?e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(f,{htmlFor:s.key,children:s.key},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:280,columnNumber:11},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:s.description},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:281,columnNumber:11},this),e.jsxDEV(U,{id:s.key,type:"number",value:a,onChange:i=>g(s.key,i.target.value)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:282,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:279,columnNumber:9},this):e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(f,{htmlFor:s.key,children:s.key},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:295,columnNumber:9},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:s.description},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:296,columnNumber:9},this),e.jsxDEV(U,{id:s.key,type:s.isEncrypted?"password":"text",value:a,onChange:i=>g(s.key,i.target.value)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:297,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:294,columnNumber:7},this)};if(_)return e.jsxDEV("div",{className:"flex items-center justify-center h-96",children:e.jsxDEV(Z,{className:"h-8 w-8 animate-spin text-primary"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:310,columnNumber:9},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:309,columnNumber:7},this);const O=u?.settings.filter(s=>s.category===N)||[];return e.jsxDEV("div",{className:"p-6 space-y-6",children:[e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{children:[e.jsxDEV("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-3",children:[e.jsxDEV(P,{className:"h-8 w-8"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:323,columnNumber:13},this),"System Configuration"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:322,columnNumber:11},this),e.jsxDEV("p",{className:"text-muted-foreground mt-2",children:"Manage system-wide settings and preferences. Changes take effect immediately."},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:326,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:321,columnNumber:9},this),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(l,{variant:"outline",onClick:()=>x.mutate(),disabled:x.isPending,className:"gap-2",children:[e.jsxDEV(q,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:337,columnNumber:13},this),"Export"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:331,columnNumber:11},this),e.jsxDEV(l,{variant:"outline",className:"gap-2",children:[e.jsxDEV(ee,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:341,columnNumber:13},this),"Import"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:340,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:330,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:320,columnNumber:7},this),e.jsxDEV(K,{value:N,onValueChange:w,className:"space-y-4",children:[e.jsxDEV(z,{className:"grid w-full grid-cols-7",children:V.map(s=>{const a=s.icon;return e.jsxDEV(H,{value:s.name,className:"gap-2",children:[e.jsxDEV(a,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:354,columnNumber:17},this),s.name.charAt(0).toUpperCase()+s.name.slice(1)]},s.name,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:353,columnNumber:15},this)})},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:349,columnNumber:9},this),V.map(s=>e.jsxDEV(J,{value:s.name,className:"space-y-4",children:e.jsxDEV(D,{children:[e.jsxDEV(v,{children:[e.jsxDEV(C,{className:"flex items-center gap-2",children:[(()=>{const a=s.icon;return e.jsxDEV(a,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:368,columnNumber:28},this)})(),s.name.charAt(0).toUpperCase()+s.name.slice(1)," Settings"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:365,columnNumber:17},this),e.jsxDEV(k,{children:s.description},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:372,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:364,columnNumber:15},this),e.jsxDEV(E,{className:"space-y-6",children:O.map(a=>e.jsxDEV("div",{className:"pb-6 border-b last:border-0 last:pb-0",children:[B(a),e.jsxDEV("div",{className:"flex items-center gap-2 mt-4",children:[e.jsxDEV(l,{onClick:()=>T(a.key),disabled:!m(a.key)||b.isPending,size:"sm",className:"gap-2",children:[e.jsxDEV(ne,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:387,columnNumber:25},this),m(a.key)?"Save Changes":"Saved"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:381,columnNumber:23},this),e.jsxDEV(l,{onClick:()=>R(a.key),disabled:h.isPending,variant:"outline",size:"sm",className:"gap-2",children:[e.jsxDEV(te,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:398,columnNumber:25},this),"Reset to Default"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:391,columnNumber:23},this),a.isEncrypted&&e.jsxDEV(j,{variant:"secondary",className:"ml-auto gap-1",children:[e.jsxDEV(re,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:404,columnNumber:27},this),"Encrypted"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:403,columnNumber:25},this),m(a.key)&&e.jsxDEV(j,{variant:"outline",className:"gap-1",children:[e.jsxDEV(L,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:411,columnNumber:27},this),"Unsaved"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:410,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:380,columnNumber:21},this),e.jsxDEV("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[e.jsxDEV("span",{children:["Default: ",a.defaultValue]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:419,columnNumber:23},this),e.jsxDEV("span",{children:"•"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:420,columnNumber:23},this),e.jsxDEV("span",{children:["Last modified: ",new Date(a.lastModified).toLocaleString()]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:421,columnNumber:23},this),a.modifiedBy&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV("span",{children:"•"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:424,columnNumber:27},this),e.jsxDEV("span",{children:["by ",a.modifiedBy]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:425,columnNumber:27},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:423,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:418,columnNumber:21},this)]},a.key,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:374,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:363,columnNumber:13},this)},s.name,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:362,columnNumber:11},this))]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:348,columnNumber:7},this),e.jsxDEV(D,{children:[e.jsxDEV(v,{children:[e.jsxDEV(C,{className:"flex items-center gap-2",children:[e.jsxDEV(I,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:441,columnNumber:13},this),"Recent Configuration Changes"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:440,columnNumber:11},this),e.jsxDEV(k,{children:"Track who changed what and when"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:444,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:439,columnNumber:9},this),e.jsxDEV(E,{children:d?.changes&&d.changes.length>0?e.jsxDEV("div",{className:"space-y-3",children:d.changes.slice(0,10).map((s,a)=>e.jsxDEV("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV("p",{className:"font-medium",children:s.key},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:454,columnNumber:21},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:['Changed from "',s.oldValue,'" to "',s.newValue,'"']},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:455,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:453,columnNumber:19},this),e.jsxDEV("div",{className:"text-right text-sm text-muted-foreground",children:[e.jsxDEV("p",{children:new Date(s.timestamp).toLocaleString()},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:460,columnNumber:21},this),e.jsxDEV("p",{children:s.modifiedBy},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:461,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:459,columnNumber:19},this)]},a,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:452,columnNumber:17},this))},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:450,columnNumber:13},this):e.jsxDEV("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsxDEV(I,{className:"h-12 w-12 mx-auto mb-2 opacity-50"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:468,columnNumber:15},this),e.jsxDEV("p",{children:"No configuration changes yet"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:469,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:467,columnNumber:13},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:448,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:438,columnNumber:7},this),Object.keys(t).length>0&&e.jsxDEV(W,{children:[e.jsxDEV(L,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:478,columnNumber:11},this),e.jsxDEV(X,{children:["You have ",Object.keys(t).length," unsaved change(s). Make sure to save your changes before leaving this page."]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:479,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:477,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/admin/SystemConfigPage.tsx",lineNumber:318,columnNumber:5},this)}export{Ce as default};
