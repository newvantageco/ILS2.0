import{r as b,e}from"./vendor-react-yzYIzJFU.js";import{u as w,a as _}from"./vendor-react-query-Dxpktacb.js";import{e as X,a1 as q,Y as K,I as oe,f as S,C as u,a as d,h as p,i as N,j as P,B as h,X as ne,a2 as ae,a4 as re,a5 as ie,a6 as le,a7 as me,a8 as ce,T as Z,aq as ue,U as de,J as pe}from"./index-BiBisH8X.js";import{L as G}from"./label-DDyL8AZL.js";import{S as $,a as W,b as Y,c as Q,d as R}from"./select-BquPdUcS.js";import{i as M,a as H,e as Ne}from"./endOfWeek-qM2CKFYh.js";import{C as O}from"./calendar-GUm2wtPp.js";import{C as ee}from"./clock-CfQc0zyb.js";import{t as be,c as he,m as xe}from"./en-US-816ENOvV.js";import{U as De}from"./user-B9YQAmBR.js";import{f as x,s as ge,a as fe}from"./format-B8W-xB4I.js";import{T as ke}from"./trending-down-Blp7mZZh.js";import{R as Se}from"./refresh-cw-C3bXnO94.js";import{c as se}from"./constructNow-C4Sbj-pp.js";import"./vendor-mui-DFe-F-Gn.js";import"./vendor-radix-B6etWzp2.js";function ve(i,n){const t=+be(i);return he(i,t+n)}function z(i,n){return ve(i,n*xe)}function J(i){return M(i,se(i))}function Te(i){return M(i,H(se(i),1))}function Ee({testRoomId:i,onBookingCreated:n}){const[t,r]=b.useState(new Date),[a,v]=b.useState(i||""),[D,s]=b.useState(!1),[m,g]=b.useState(null),{toast:T}=X(),{data:L}=w({queryKey:["/api/ecp/test-rooms"]}),{data:E,isLoading:C}=w({queryKey:["/api/ecp/test-room-bookings",t,a],enabled:!!a}),U=_({mutationFn:async o=>await(await K("POST","/api/ecp/test-room-bookings",o)).json(),onSuccess:o=>{q.invalidateQueries({queryKey:["/api/ecp/test-room-bookings"]}),T({title:"Booking Created",description:"Test room has been booked successfully."}),s(!1),g(null),n?.(o)},onError:o=>{console.error("Booking creation error:",o),T({title:"Error",description:o.message||"Failed to create booking. Please try again.",variant:"destructive"})}}),I=_({mutationFn:async o=>await(await K("DELETE",`/api/ecp/test-room-bookings/${o}`)).json(),onSuccess:()=>{q.invalidateQueries({queryKey:["/api/ecp/test-room-bookings"]}),T({title:"Booking Cancelled",description:"The booking has been cancelled."})}}),y=o=>{if(o.preventDefault(),!m||!a)return;const l=new FormData(o.currentTarget),c={testRoomId:a,bookingDate:t.toISOString(),startTime:m.start.toISOString(),endTime:m.end.toISOString(),appointmentType:l.get("appointmentType")||null};U.mutate(c)},V=o=>{const l=new Date(t);l.setHours(o,0,0,0);const c=new Date(l);if(c.setHours(o+1),E?.some(B=>{const F=new Date(B.startTime),A=new Date(B.endTime);return l>=F&&l<A||c>F&&c<=A||l<=F&&c>=A})){T({title:"Time Slot Unavailable",description:"This time slot is already booked.",variant:"destructive"});return}g({start:l,end:c}),s(!0)},f=o=>E?.filter(l=>{const c=new Date(l.startTime);return M(c,t)&&c.getHours()===o})||[],te=Array.from({length:12},(o,l)=>l+9);return e.jsxDEV("div",{className:"space-y-6",children:[e.jsxDEV("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxDEV("div",{className:"flex-1 min-w-[200px]",children:[e.jsxDEV(G,{htmlFor:"room-select",children:"Test Room"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:173,columnNumber:11},this),e.jsxDEV($,{value:a,onValueChange:v,children:[e.jsxDEV(W,{id:"room-select",children:e.jsxDEV(Y,{placeholder:"Select test room..."},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:176,columnNumber:15},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:175,columnNumber:13},this),e.jsxDEV(Q,{children:L?.map(o=>e.jsxDEV(R,{value:o.id,children:[o.roomName," ",o.roomCode&&`(${o.roomCode})`]},o.id,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:180,columnNumber:17},this))},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:178,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:174,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:172,columnNumber:9},this),e.jsxDEV("div",{className:"flex-1 min-w-[200px]",children:[e.jsxDEV(G,{htmlFor:"date-select",children:"Date"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:189,columnNumber:11},this),e.jsxDEV(oe,{id:"date-select",type:"date",value:x(t,"yyyy-MM-dd"),onChange:o=>r(new Date(o.target.value))},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:190,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:188,columnNumber:9},this),e.jsxDEV("div",{className:"flex gap-2 pt-6",children:[e.jsxDEV(S,{variant:"outline",onClick:()=>r(H(t,-1)),children:"Previous"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:199,columnNumber:11},this),e.jsxDEV(S,{variant:"outline",onClick:()=>r(new Date),children:"Today"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:205,columnNumber:11},this),e.jsxDEV(S,{variant:"outline",onClick:()=>r(H(t,1)),children:"Next"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:211,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:198,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:171,columnNumber:7},this),a?C?e.jsxDEV("div",{className:"h-96 bg-muted animate-pulse rounded"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:231,columnNumber:9},this):e.jsxDEV(u,{children:[e.jsxDEV(p,{children:[e.jsxDEV(N,{children:x(t,"EEEE, MMMM d, yyyy")},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:235,columnNumber:13},this),e.jsxDEV(P,{children:"Click on a time slot to create a booking"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:238,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:234,columnNumber:11},this),e.jsxDEV(d,{children:e.jsxDEV("div",{className:"space-y-2",children:te.map(o=>{const l=f(o),c=l.length>0;return e.jsxDEV("div",{className:`p-4 border rounded-lg transition-colors ${c?"bg-primary/10 border-primary cursor-not-allowed":"hover:bg-accent cursor-pointer"}`,onClick:()=>!c&&V(o),children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"flex items-center gap-3",children:[e.jsxDEV(ee,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:260,columnNumber:25},this),e.jsxDEV("span",{className:"font-medium",children:[x(z(new Date().setHours(o,0,0,0),0),"h:mm a")," -"," ",x(z(new Date().setHours(o,0,0,0),1),"h:mm a")]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:261,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:259,columnNumber:23},this),c?e.jsxDEV("div",{className:"flex items-center gap-2",children:l.map(k=>e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(h,{variant:"default",children:k.patient?.name||"No patient"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:270,columnNumber:31},this),e.jsxDEV(h,{variant:"outline",children:[e.jsxDEV(De,{className:"h-3 w-3 mr-1"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:274,columnNumber:33},this),k.user.name]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:273,columnNumber:31},this),k.appointmentType&&e.jsxDEV(h,{variant:"secondary",children:k.appointmentType},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:278,columnNumber:33},this),e.jsxDEV(S,{size:"sm",variant:"ghost",onClick:B=>{B.stopPropagation(),I.mutate(k.id)},children:e.jsxDEV(ne,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:290,columnNumber:33},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:282,columnNumber:31},this)]},k.id,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:269,columnNumber:29},this))},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:267,columnNumber:25},this):e.jsxDEV(h,{variant:"outline",children:"Available"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:296,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:258,columnNumber:21},this)},o,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:249,columnNumber:19},this)})},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:243,columnNumber:13},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:242,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:233,columnNumber:9},this):e.jsxDEV(u,{children:e.jsxDEV(d,{className:"py-12 text-center",children:[e.jsxDEV(O,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:223,columnNumber:13},this),e.jsxDEV("h3",{className:"text-lg font-semibold mb-2",children:"Select a Test Room"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:224,columnNumber:13},this),e.jsxDEV("p",{className:"text-muted-foreground",children:"Choose a test room to view and manage bookings"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:225,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:222,columnNumber:11},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:221,columnNumber:9},this),e.jsxDEV(ae,{open:D,onOpenChange:s,children:e.jsxDEV(re,{children:e.jsxDEV("form",{onSubmit:y,children:[e.jsxDEV(ie,{children:[e.jsxDEV(le,{children:"Create Booking"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:312,columnNumber:15},this),e.jsxDEV(me,{children:m&&e.jsxDEV(e.Fragment,{children:["Book test room for"," ",x(m.start,"h:mm a")," -"," ",x(m.end,"h:mm a")]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:315,columnNumber:19},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:313,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:311,columnNumber:13},this),e.jsxDEV("div",{className:"grid gap-4 py-4",children:e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(G,{htmlFor:"appointmentType",children:"Appointment Type"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:325,columnNumber:17},this),e.jsxDEV($,{name:"appointmentType",children:[e.jsxDEV(W,{children:e.jsxDEV(Y,{placeholder:"Select type..."},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:328,columnNumber:21},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:327,columnNumber:19},this),e.jsxDEV(Q,{children:[e.jsxDEV(R,{value:"Routine Eye Test",children:"Routine Eye Test"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:331,columnNumber:21},this),e.jsxDEV(R,{value:"Contact Lens Fitting",children:"Contact Lens Fitting"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:332,columnNumber:21},this),e.jsxDEV(R,{value:"Follow-up Examination",children:"Follow-up Examination"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:333,columnNumber:21},this),e.jsxDEV(R,{value:"Emergency Appointment",children:"Emergency Appointment"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:334,columnNumber:21},this),e.jsxDEV(R,{value:"Pediatric Examination",children:"Pediatric Examination"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:335,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:330,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:326,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:324,columnNumber:15},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:323,columnNumber:13},this),e.jsxDEV(ce,{children:[e.jsxDEV(S,{type:"button",variant:"outline",onClick:()=>{s(!1),g(null)},children:"Cancel"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:341,columnNumber:15},this),e.jsxDEV(S,{type:"submit",disabled:U.isPending,children:U.isPending?"Creating...":"Create Booking"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:351,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:340,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:310,columnNumber:11},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:309,columnNumber:9},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:308,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/test-room/TestRoomScheduler.tsx",lineNumber:169,columnNumber:5},this)}class Ue{constructor(){this.cache=new Map,this.CACHE_DURATION=3600*1e3,this.API_KEY=""}async getGBPtoUSD(){const n=this.cache.get("GBP_USD");if(n&&Date.now()-n.lastUpdated.getTime()<this.CACHE_DURATION)return n.rate;try{const t=await this.fetchFromExchangeRateAPI();return this.cache.set("GBP_USD",{rate:t,lastUpdated:new Date}),t}catch(t){console.error("Primary API failed, trying fallback:",t);try{const r=await this.fetchFromOpenExchangeRates();return this.cache.set("GBP_USD",{rate:r,lastUpdated:new Date}),r}catch(r){return console.error("Fallback API failed:",r),n?(console.warn("Using expired cache due to API failures"),n.rate):(console.warn("Using approximate exchange rate"),1.27)}}}async fetchFromExchangeRateAPI(){const n=await fetch("https://api.exchangerate-api.com/v4/latest/GBP");if(!n.ok)throw new Error(`API returned ${n.status}`);return(await n.json()).rates.USD}async fetchFromOpenExchangeRates(){const n=this.API_KEY?`https://openexchangerates.org/api/latest.json?app_id=${this.API_KEY}&base=GBP&symbols=USD`:"https://openexchangerates.org/api/latest.json?base=GBP&symbols=USD",t=await fetch(n);if(!t.ok)throw new Error(`API returned ${t.status}`);return(await t.json()).rates.USD}async convertGBPtoUSD(n){const t=await this.getGBPtoUSD();return n*t}async convertUSDtoGBP(n){const t=await this.getGBPtoUSD();return n/t}formatCurrency(n,t){return new Intl.NumberFormat("en-GB",{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}).format(n)}clearCache(){this.cache.clear()}getCacheAge(){const n=this.cache.get("GBP_USD");return n?Math.floor((Date.now()-n.lastUpdated.getTime())/(60*1e3)):null}}const j=new Ue;function Ie({gbpAmount:i,showCard:n=!0,className:t=""}){const[r,a]=b.useState(null),[v,D]=b.useState(!0),[s,m]=b.useState(null),[g,T]=b.useState(null),{toast:L}=X(),E=async()=>{D(!0);try{const f=await j.getGBPtoUSD();a(f),m(new Date),T(j.getCacheAge())}catch(f){console.error("Failed to fetch exchange rate:",f),L({title:"Currency Rate Error",description:"Failed to fetch live exchange rate. Using approximate rate.",variant:"destructive"})}finally{D(!1)}};b.useEffect(()=>{E();const f=setInterval(E,300*1e3);return()=>clearInterval(f)},[]);const C=()=>{j.clearCache(),E(),L({title:"Rate Refreshed",description:"Exchange rate has been updated."})},U=i&&r?i*r:null,I=r?((r-1.25)/1.25*100).toFixed(2):null,y=I?parseFloat(I)>0:!1,V=e.jsxDEV("div",{className:t,children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("span",{className:"text-sm font-medium text-muted-foreground",children:"Exchange Rate:"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:68,columnNumber:13},this),e.jsxDEV("span",{className:"text-lg font-bold",children:["1 GBP = ",v?"...":r?`${r.toFixed(4)} USD`:"N/A"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:69,columnNumber:13},this),I&&e.jsxDEV(h,{variant:y?"default":"secondary",className:"gap-1",children:[y?e.jsxDEV(Z,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:74,columnNumber:31},this):e.jsxDEV(ke,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:74,columnNumber:68},this),I,"%"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:73,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:67,columnNumber:11},this),i&&U&&e.jsxDEV("div",{className:"flex items-center gap-4 text-sm",children:e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("span",{className:"font-semibold text-green-600 dark:text-green-400",children:j.formatCurrency(i,"GBP")},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:83,columnNumber:17},this),e.jsxDEV("span",{className:"text-muted-foreground",children:"="},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:86,columnNumber:17},this),e.jsxDEV("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:j.formatCurrency(U,"USD")},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:87,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:82,columnNumber:15},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:81,columnNumber:13},this),e.jsxDEV("div",{className:"text-xs text-muted-foreground",children:s&&e.jsxDEV("span",{children:["Last updated: ",s.toLocaleTimeString(),g!==null&&g>0&&` (${g}m ago)`]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:96,columnNumber:15},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:94,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:66,columnNumber:9},this),e.jsxDEV(S,{variant:"outline",size:"sm",onClick:C,disabled:v,className:"gap-2",children:[e.jsxDEV(Se,{className:`h-4 w-4 ${v?"animate-spin":""}`},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:111,columnNumber:11},this),"Refresh"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:104,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:65,columnNumber:7},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:64,columnNumber:5},this);return n?e.jsxDEV(u,{children:[e.jsxDEV(p,{children:e.jsxDEV(N,{className:"text-base",children:"Live Currency Rates"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:125,columnNumber:9},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:124,columnNumber:7},this),e.jsxDEV(d,{children:V},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:127,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/components/CurrencyDisplay.tsx",lineNumber:123,columnNumber:5},this):V}function qe(){ge(new Date);const i=fe(new Date,{weekStartsOn:1}),n=Ne(new Date,{weekStartsOn:1}),{data:t}=w({queryKey:["/api/ecp/test-room-bookings"]}),{data:r}=w({queryKey:["/api/ecp/test-rooms"]}),a={todayBookings:t?.filter(s=>J(new Date(s.bookingDate))).length||0,weekBookings:t?.filter(s=>{const m=new Date(s.bookingDate);return m>=i&&m<=n}).length||0,availableRooms:r?.filter(s=>s.currentStatus==="available").length||0,upcomingToday:t?.filter(s=>J(new Date(s.bookingDate))&&new Date(s.startTime)>new Date&&s.status==="scheduled").sort((s,m)=>new Date(s.startTime).getTime()-new Date(m.startTime).getTime())||[],upcomingTomorrow:t?.filter(s=>Te(new Date(s.bookingDate))&&s.status==="scheduled").sort((s,m)=>new Date(s.startTime).getTime()-new Date(m.startTime).getTime())||[]},D=a.weekBookings*50;return e.jsxDEV("div",{className:"space-y-6",children:[e.jsxDEV("div",{children:[e.jsxDEV("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-3",children:[e.jsxDEV(O,{className:"h-8 w-8"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:81,columnNumber:11},this),"Test Room Diary & Scheduling"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:80,columnNumber:9},this),e.jsxDEV("p",{className:"text-muted-foreground mt-1",children:"Manage test room bookings and appointments"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:84,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:79,columnNumber:7},this),e.jsxDEV("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxDEV(u,{children:[e.jsxDEV(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxDEV(N,{className:"text-sm font-medium",children:"Today's Bookings"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:93,columnNumber:13},this),e.jsxDEV(ue,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:94,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:92,columnNumber:11},this),e.jsxDEV(d,{children:[e.jsxDEV("div",{className:"text-2xl font-bold",children:a.todayBookings},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:97,columnNumber:13},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:[a.upcomingToday.length," upcoming"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:98,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:96,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:91,columnNumber:9},this),e.jsxDEV(u,{children:[e.jsxDEV(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxDEV(N,{className:"text-sm font-medium",children:"This Week"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:106,columnNumber:13},this),e.jsxDEV(Z,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:107,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:105,columnNumber:11},this),e.jsxDEV(d,{children:[e.jsxDEV("div",{className:"text-2xl font-bold",children:a.weekBookings},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:110,columnNumber:13},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Total appointments"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:111,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:109,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:104,columnNumber:9},this),e.jsxDEV(u,{children:[e.jsxDEV(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxDEV(N,{className:"text-sm font-medium",children:"Available Rooms"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:119,columnNumber:13},this),e.jsxDEV(de,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:120,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:118,columnNumber:11},this),e.jsxDEV(d,{children:[e.jsxDEV("div",{className:"text-2xl font-bold",children:a.availableRooms},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:123,columnNumber:13},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:["of ",r?.length||0," total"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:124,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:122,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:117,columnNumber:9},this),e.jsxDEV(u,{children:[e.jsxDEV(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxDEV(N,{className:"text-sm font-medium",children:"Week Revenue"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:132,columnNumber:13},this),e.jsxDEV(pe,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:133,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:131,columnNumber:11},this),e.jsxDEV(d,{children:[e.jsxDEV("div",{className:"text-2xl font-bold",children:["Â£",D.toLocaleString()]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:136,columnNumber:13},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Estimated"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:137,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:135,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:130,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:90,columnNumber:7},this),e.jsxDEV(Ie,{gbpAmount:D},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:145,columnNumber:7},this),e.jsxDEV("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxDEV(u,{children:[e.jsxDEV(p,{children:[e.jsxDEV(N,{className:"text-base flex items-center gap-2",children:[e.jsxDEV(ee,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:153,columnNumber:15},this),"Today's Upcoming Appointments"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:152,columnNumber:13},this),e.jsxDEV(P,{children:"Next appointments for today"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:156,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:151,columnNumber:11},this),e.jsxDEV(d,{children:a.upcomingToday.length===0?e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"No upcoming appointments today"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:160,columnNumber:15},this):e.jsxDEV("div",{className:"space-y-3",children:[a.upcomingToday.slice(0,5).map(s=>e.jsxDEV("div",{className:"flex items-start justify-between border-l-2 border-primary pl-3",children:[e.jsxDEV("div",{className:"space-y-1",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(h,{variant:"outline",className:"text-xs",children:x(new Date(s.startTime),"HH:mm")},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:167,columnNumber:25},this),e.jsxDEV("span",{className:"font-medium text-sm",children:s.patient?.name||"No patient"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:170,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:166,columnNumber:23},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:s.appointmentType||"General appointment"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:174,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:165,columnNumber:21},this),e.jsxDEV(h,{variant:"secondary",className:"text-xs",children:s.room?.roomName||"Room"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:178,columnNumber:21},this)]},s.id,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:164,columnNumber:19},this)),a.upcomingToday.length>5&&e.jsxDEV("p",{className:"text-xs text-muted-foreground pt-2",children:["+",a.upcomingToday.length-5," more appointments"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:184,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:162,columnNumber:15},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:158,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:150,columnNumber:9},this),e.jsxDEV(u,{children:[e.jsxDEV(p,{children:[e.jsxDEV(N,{className:"text-base flex items-center gap-2",children:[e.jsxDEV(O,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:197,columnNumber:15},this),"Tomorrow's Appointments"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:196,columnNumber:13},this),e.jsxDEV(P,{children:"Scheduled for tomorrow"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:200,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:195,columnNumber:11},this),e.jsxDEV(d,{children:a.upcomingTomorrow.length===0?e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"No appointments scheduled for tomorrow"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:204,columnNumber:15},this):e.jsxDEV("div",{className:"space-y-3",children:[a.upcomingTomorrow.slice(0,5).map(s=>e.jsxDEV("div",{className:"flex items-start justify-between border-l-2 border-blue-500 pl-3",children:[e.jsxDEV("div",{className:"space-y-1",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(h,{variant:"outline",className:"text-xs",children:x(new Date(s.startTime),"HH:mm")},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:211,columnNumber:25},this),e.jsxDEV("span",{className:"font-medium text-sm",children:s.patient?.name||"No patient"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:214,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:210,columnNumber:23},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:s.appointmentType||"General appointment"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:218,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:209,columnNumber:21},this),e.jsxDEV(h,{variant:"secondary",className:"text-xs",children:s.room?.roomName||"Room"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:222,columnNumber:21},this)]},s.id,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:208,columnNumber:19},this)),a.upcomingTomorrow.length>5&&e.jsxDEV("p",{className:"text-xs text-muted-foreground pt-2",children:["+",a.upcomingTomorrow.length-5," more appointments"]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:228,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:206,columnNumber:15},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:202,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:194,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:148,columnNumber:7},this),e.jsxDEV(u,{children:[e.jsxDEV(p,{children:[e.jsxDEV(N,{children:"Booking Calendar"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:241,columnNumber:11},this),e.jsxDEV(P,{children:"Select a date and time to book a test room"},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:242,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:240,columnNumber:9},this),e.jsxDEV(d,{children:e.jsxDEV(Ee,{},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:245,columnNumber:11},this)},void 0,!1,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:244,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:239,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/saban/Desktop/ILS2.0/client/src/pages/TestRoomBookingsPage.tsx",lineNumber:77,columnNumber:5},this)}export{qe as default};
