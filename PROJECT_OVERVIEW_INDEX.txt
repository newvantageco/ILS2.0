================================================================================
ILS 2.0 - PROJECT OVERVIEW - QUICK INDEX
================================================================================

Project Name: Integrated Lens System 2.0 (ILS 2.0)
Description: Healthcare Operating System for Optical Excellence
Status: Production Ready (98.5% Health Score)
Version: 2.0

================================================================================
OVERVIEW DOCUMENTATION STRUCTURE
================================================================================

This project overview has been split into 3 comprehensive parts:

ğŸ“„ PROJECT_OVERVIEW_PART1.txt (Introduction & Foundation)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Contents:
  â€¢ What is ILS 2.0
  â€¢ Key Features Overview
  â€¢ Complete Technology Stack
  â€¢ Project Structure
  â€¢ Database Schema Overview
  â€¢ Environment Variables Checklist

Best for: Understanding the big picture, tech stack, features

ğŸ“„ PROJECT_OVERVIEW_PART2.txt (Architecture & Development)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Contents:
  â€¢ System Architecture (layered & high-level diagrams)
  â€¢ Data Flow Patterns (order creation, AI queries, background jobs)
  â€¢ Authentication & Authorization (RBAC, multi-tenancy)
  â€¢ Event-Driven Architecture (pub/sub pattern, EventBus)
  â€¢ Background Jobs (BullMQ + Redis)
  â€¢ File Upload & Processing
  â€¢ Logging & Monitoring
  â€¢ Cron Jobs (scheduled tasks)

Best for: Understanding how components interact, development patterns

ğŸ“„ PROJECT_OVERVIEW_PART3.txt (Development, Testing & Deployment)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Contents:
  â€¢ Testing Strategy (unit, integration, component, E2E)
  â€¢ Development Workflow (8-step feature development pattern)
  â€¢ Database Schema Management (migrations, conventions)
  â€¢ Deployment (production build, Railway, Docker)
  â€¢ Troubleshooting & Maintenance
  â€¢ Quick Reference Commands

Best for: Implementing features, running tests, deploying to production

================================================================================
QUICK START FOR NEW DEVELOPERS
================================================================================

1. UNDERSTAND THE ARCHITECTURE (15 min)
   â†’ Read: PROJECT_OVERVIEW_PART1.txt (sections: "What is ILS 2.0" & "Tech Stack")
   â†’ Read: PROJECT_OVERVIEW_PART2.txt (section: "System Architecture")

2. SET UP LOCAL ENVIRONMENT (30 min)
   â†’ Clone: git clone https://github.com/newvantageco/ILS2.0.git
   â†’ Install: npm install
   â†’ Configure: cp .env.example .env (fill in DATABASE_URL, etc.)
   â†’ Migrate: npm run db:push
   â†’ Start: npm run dev

3. LEARN THE DEVELOPMENT PATTERN (30 min)
   â†’ Read: PROJECT_OVERVIEW_PART3.txt (section: "Development Workflow")
   â†’ This covers the exact steps to add ANY feature to ILS

4. UNDERSTAND MULTI-TENANCY (15 min)
   â†’ Read: PROJECT_OVERVIEW_PART2.txt (section: "Multi-Tenancy Implementation")
   â†’ This is critical - every query MUST filter by companyId

5. START IMPLEMENTING (as needed)
   â†’ Follow the 8-step development pattern
   â†’ Run: npm run check && npm test before committing

================================================================================
KEY CONCEPTS TO UNDERSTAND
================================================================================

MONOREPO STRUCTURE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ client/     â†’ React frontend (Vite + TypeScript)
â€¢ server/     â†’ Express backend (TypeScript ESM)
â€¢ shared/     â†’ Shared types & Zod schemas (SINGLE SOURCE OF TRUTH)
â€¢ python-service/ â†’ FastAPI analytics
â€¢ ai-service/ â†’ ML & AI models
â€¢ test/       â†’ All test suites

SINGLE SOURCE OF TRUTH
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
shared/schema.ts contains:
  â€¢ 110+ Drizzle ORM table definitions
  â€¢ Zod validation schemas (auto-generated)
  â€¢ ALL TypeScript types are derived from this

Process: Schema change â†’ Database migration â†’ Code change

DATA ACCESS PATTERN
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Routes NEVER query database directly!

Pattern:
  Frontend â†’ Route handler â†’ Storage layer â†’ Database

The DbStorage singleton (server/storage.ts) enforces:
  â€¢ Tenant isolation (companyId filtering)
  â€¢ Type safety (Zod validation)
  â€¢ Query optimization (indexes, caching)
  â€¢ Consistent error handling

MULTI-TENANCY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
CRITICAL: Every query MUST include companyId filter

Two patterns:

1. Middleware extracts companyId from authenticated user:
   const companyId = req.user.companyId;

2. All storage methods filter by companyId:
   const orders = await storage.getOrdersByCompany(companyId);

Result: Complete data isolation between companies

ERROR HANDLING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
All async routes use asyncHandler() wrapper:

  router.post('/api/orders',
    authenticateUser,
    asyncHandler(async (req, res) => {
      if (!data) throw new NotFoundError('Order');
      res.json(data);
    })
  );

No try/catch needed - asyncHandler catches all errors and formats response.

EVENT-DRIVEN ARCHITECTURE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
After state changes, emit events:

  const order = await storage.createOrder(data);
  await EventBus.publish('order.created', { orderId, companyId });

Event handlers run asynchronously:
  EmailWorker â†’ Send email
  PDFWorker â†’ Generate invoice
  AnalyticsWorker â†’ Log event

Pattern: Fire-and-forget, workers handle async processing

================================================================================
DIRECTORY QUICK REFERENCE
================================================================================

Frontend (client/)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
client/src/
  components/    â†’ React components (UI, dashboard, forms)
  pages/         â†’ Route-level pages (Dashboard, Orders, etc.)
  hooks/         â†’ Custom hooks (useAuth, useOrders, etc.)
  lib/           â†’ Utilities (API client, helpers)
  App.tsx        â†’ Root component with routing

Backend (server/)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
server/
  routes.ts           â†’ Main route registry (5,800+ lines)
  routes/             â†’ Modular route files (ai.ts, payments.ts, etc.)
  storage.ts          â†’ Data access layer (6,200+ lines, CORE FILE)
  db.ts               â†’ Database connection
  middleware/         â†’ Express middleware (auth, errors, security)
  workers/            â†’ BullMQ background workers (email, PDF, AI)
  events/             â†’ Event bus and handlers
  services/           â†’ Business logic services
  jobs/               â†’ Cron-scheduled tasks
  queue/              â†’ BullMQ configuration
  websocket/          â†’ WebSocket server

Shared (shared/)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
schema.ts          â†’ 110+ Drizzle tables, 8,400+ lines (SOURCE OF TRUTH)

Testing (test/)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
test/
  unit/              â†’ Unit tests (Jest)
  integration/       â†’ API tests (Jest + Supertest)
  components/        â†’ React component tests (Vitest)
  e2e/               â†’ Browser tests (Playwright)

Config Files
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
package.json           â†’ Dependencies and scripts
tsconfig.json          â†’ TypeScript configuration
vite.config.ts         â†’ Frontend build config
jest.config.mjs        â†’ Testing config
drizzle.config.ts      â†’ ORM config
docker-compose.yml     â†’ Local dev services

================================================================================
TECHNOLOGY AT A GLANCE
================================================================================

FRONTEND
â”€â”€â”€â”€â”€â”€â”€â”€
React 18.3           â†’ UI framework
TypeScript 5.6       â†’ Type safety
Vite 7.2             â†’ Fast dev server
TanStack Query 5     â†’ Server state management
Wouter 3.3           â†’ Lightweight routing
shadcn/ui + Radix    â†’ Component primitives
Tailwind CSS 3.4     â†’ Styling
React Hook Form      â†’ Form management
Zod 3.24             â†’ Type validation

BACKEND
â”€â”€â”€â”€â”€â”€â”€â”€
Node.js 20+          â†’ Runtime
Express 4.21         â†’ Web framework
PostgreSQL 15        â†’ Database (Neon recommended)
Drizzle ORM 0.44     â†’ Type-safe queries
Passport 0.7         â†’ Authentication
BullMQ 5.63          â†’ Job queue
Redis 5.8            â†’ Cache & job store
Socket.io            â†’ WebSockets
Helmet 8.1           â†’ Security headers
Pino 10.1            â†’ JSON logging

TESTING
â”€â”€â”€â”€â”€â”€â”€â”€
Jest 29.7            â†’ Unit & integration tests
Vitest 4.0           â†’ Component tests
Playwright 1.56      â†’ E2E tests
React Testing Lib    â†’ Component utilities

PYTHON SERVICES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FastAPI              â†’ API framework
TensorFlow.js        â†’ ML models
PyTorch              â†’ Deep learning
Pandas               â†’ Data analysis
scikit-learn         â†’ Classical ML
Anthropic Claude     â†’ LLM
OpenAI GPT-4         â†’ LLM

================================================================================
ESSENTIAL COMMANDS
================================================================================

DEVELOPMENT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
npm run dev              Start all services (client + server + Python)
npm run dev:node         Start Node.js backend only
npm run dev:python       Start Python analytics service
npm run check            TypeScript type checking

DATABASE
â”€â”€â”€â”€â”€â”€â”€â”€â”€
npm run db:push          Run migrations to database
npm run migrate-storage  Run data migration scripts

TESTING
â”€â”€â”€â”€â”€â”€â”€â”€
npm run test:unit        Unit tests (Jest)
npm test                 Integration tests (API)
npm run test:components  Component tests (React)
npm run test:e2e         End-to-end tests (Playwright)
npm run test:all         All tests + TypeScript check
npm run test:coverage    Coverage report

PRODUCTION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
npm run build            Build for production
npm start                Start production server

QUALITY
â”€â”€â”€â”€â”€â”€â”€â”€
npm run check            TypeScript compilation
npm run test:coverage    Test coverage report

DEPLOYMENT (Railway)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
railway login            Login to Railway
railway link             Link this project
railway up               Deploy
railway logs --follow    Watch deployment logs

================================================================================
FILE ORGANIZATION TIPS
================================================================================

When modifying code, follow this pattern:

For frontend changes:
  1. Update schema if needed (shared/schema.ts)
  2. Update backend storage/route (server/storage.ts, server/routes.ts)
  3. Update frontend hook (client/src/hooks/)
  4. Update component (client/src/components/)
  5. Add tests

For backend-only changes:
  1. Update schema if DB changed (shared/schema.ts)
  2. Update storage method (server/storage.ts)
  3. Update route handler (server/routes.ts or modular file)
  4. Emit events if needed
  5. Add tests

For database changes:
  1. Update Drizzle schema (shared/schema.ts)
  2. Run: npm run db:push
  3. Update storage methods
  4. Update routes
  5. Update types (automatic from schema)

For external integrations:
  1. Create service class (server/services/)
  2. Use in route handlers
  3. Emit events if state-changing
  4. Add tests

================================================================================
COMMON PAIN POINTS & SOLUTIONS
================================================================================

âŒ "TypeError: cannot access companyId"
âœ… Always get companyId from req.user (after authenticateUser middleware)
âœ… Always pass companyId to storage methods

âŒ "Data visible across multiple companies"
âœ… Missing companyId filter in storage method
âœ… Review server/storage.ts - ALL methods must filter by companyId

âŒ "Background jobs not running"
âœ… Check Redis connection: redis-cli ping
âœ… Check if job worker is imported in server/index.ts
âœ… Check BullMQ queue: redis-cli KEYS bull:*

âŒ "TypeScript errors in client/"
âœ… Run npm run check to see all errors
âœ… Check path aliases in tsconfig.json
âœ… Use @shared/ for shared types

âŒ "Tests failing unexpectedly"
âœ… Ensure test database is clean: npm run db:push
âœ… Check for port conflicts (5000, 8000, 6379)
âœ… Run tests individually: npm run test:unit

================================================================================
LEARNING PATHS
================================================================================

FOR FRONTEND DEVELOPERS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Learn React components structure (client/src/components/)
2. Learn React hooks pattern (client/src/hooks/)
3. Learn TanStack Query for data fetching
4. Learn Zod for form validation
5. Add new UI components and hooks
6. Add integration tests for components

FOR BACKEND DEVELOPERS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Learn storage layer pattern (server/storage.ts)
2. Learn route handler pattern (server/routes.ts)
3. Learn Zod schema validation (shared/schema.ts)
4. Learn event-driven pattern (server/events/)
5. Learn background job pattern (server/workers/)
6. Add new API endpoints and storage methods

FOR FULLSTACK DEVELOPERS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Follow the 8-step development workflow (PROJECT_OVERVIEW_PART3.txt)
2. Understand schema â†’ storage â†’ routes â†’ frontend pattern
3. Learn multi-tenancy enforcement (PROJECT_OVERVIEW_PART2.txt)
4. Learn event-driven architecture
5. Implement complete features end-to-end

FOR DATABASE ADMINISTRATORS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Understand Drizzle ORM (shared/schema.ts)
2. Learn migration process (npm run db:push)
3. Monitor query performance (indexes, explain plans)
4. Backup strategy
5. Connection pooling (Neon automatic)

================================================================================
ADDITIONAL RESOURCES
================================================================================

Documentation in repo:
â€¢ README.md                    - Main project documentation
â€¢ docs/architecture.md         - System architecture deep dive
â€¢ docs/development.md          - Developer guide
â€¢ docs/database.md             - Database schema documentation
â€¢ docs/deployment.md           - Deployment guide
â€¢ docs/compliance.md           - HIPAA/GDPR compliance
â€¢ CONTRIBUTING.md              - Contribution guidelines
â€¢ .github/copilot-instructions.md - AI agent guidance

External resources:
â€¢ React: https://react.dev
â€¢ TypeScript: https://www.typescriptlang.org
â€¢ Express: https://expressjs.com
â€¢ Drizzle ORM: https://orm.drizzle.team
â€¢ Zod: https://zod.dev
â€¢ TanStack Query: https://tanstack.com/query
â€¢ Tailwind CSS: https://tailwindcss.com

Project setup:
â€¢ See PROJECT_OVERVIEW_PART1.txt for complete tech stack details
â€¢ See PROJECT_OVERVIEW_PART2.txt for architecture diagrams
â€¢ See PROJECT_OVERVIEW_PART3.txt for deployment instructions

================================================================================
GETTING HELP
================================================================================

GitHub Issues:
  â†’ https://github.com/newvantageco/ILS2.0/issues

Documentation:
  â†’ /docs folder in repository
  â†’ .github/copilot-instructions.md for AI guidance

Code Examples:
  â†’ server/routes.ts - Examples of all endpoint patterns
  â†’ server/storage.ts - Examples of all query patterns
  â†’ client/src/hooks/ - Examples of all hook patterns
  â†’ test/ - Examples of all test patterns

Common Tasks:
  â†’ Adding API endpoint: Follow 8-step pattern in PART3
  â†’ Adding component: Check client/src/components/ for patterns
  â†’ Adding database table: Update shared/schema.ts + npm run db:push
  â†’ Fixing bug: Write test first, then fix code

================================================================================
NEXT STEPS
================================================================================

For new developers:
  1. Read PROJECT_OVERVIEW_PART1.txt (foundation)
  2. Read PROJECT_OVERVIEW_PART2.txt (architecture)
  3. Follow setup steps in PROJECT_OVERVIEW_PART1.txt
  4. Run: npm run dev
  5. Explore codebase - open server/routes.ts and server/storage.ts
  6. Pick a small bug or feature from GitHub issues
  7. Follow 8-step development pattern from PROJECT_OVERVIEW_PART3.txt

For experienced developers:
  1. Review PROJECT_OVERVIEW_PART2.txt (architecture)
  2. Review PROJECT_OVERVIEW_PART3.txt (development workflow)
  3. Review key files:
     - shared/schema.ts (database structure)
     - server/storage.ts (data access patterns)
     - server/routes.ts (API patterns)
  4. Pick a feature to implement or bug to fix
  5. Follow the pattern, write tests, deploy

================================================================================
END OF QUICK INDEX
================================================================================

Start with: PROJECT_OVERVIEW_PART1.txt
Then read:  PROJECT_OVERVIEW_PART2.txt
Then read:  PROJECT_OVERVIEW_PART3.txt

Total reading time: ~30-45 minutes for complete overview
Practical implementation time: 1-2 hours for first feature

Good luck! ğŸš€

================================================================================
