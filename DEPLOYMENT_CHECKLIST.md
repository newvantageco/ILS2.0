# Railway Deployment Checklist

Use this checklist to ensure a smooth deployment to Railway.

## Pre-Deployment (Local Testing)

### Code Quality

- [ ] All TypeScript errors resolved: `npm run check`
- [ ] Tests passing: `npm run test:all`
- [ ] Build completes successfully: `npm run build`
- [ ] Local production test works: `NODE_ENV=production npm start`
- [ ] Code committed to Git: `git status` shows clean
- [ ] Code pushed to GitHub: `git push origin main`

### Environment Variables Prepared

- [ ] `SESSION_SECRET` generated (64 chars)
- [ ] `ADMIN_SETUP_KEY` generated (32 chars)
- [ ] Master user credentials ready:
  - [ ] Email address
  - [ ] Strong password (12+ chars)
  - [ ] First/Last name
  - [ ] Organization name
- [ ] Email service API key obtained (Resend)
- [ ] Payment API keys obtained (Stripe, if using)
- [ ] AI API keys obtained (OpenAI/Anthropic, if using)

### Documentation

- [ ] `.env.example` updated with latest variables
- [ ] Deployment guides reviewed
- [ ] Team notified of deployment window
- [ ] Rollback plan documented

---

## Railway Setup

### Project Creation

- [ ] Railway account created/logged in
- [ ] New project created
- [ ] GitHub repository connected
- [ ] Automatic deployments enabled

### Services Added

- [ ] PostgreSQL database provisioned
  - [ ] `DATABASE_URL` auto-configured
  - [ ] Connection pooling enabled
- [ ] Redis cache provisioned
  - [ ] `REDIS_URL` auto-configured
- [ ] Services are running (green status)

### Environment Variables Set

#### Core (Required)

- [ ] `NODE_ENV=production`
- [ ] `PORT=5000`
- [ ] `SESSION_SECRET=<generated-secret>`
- [ ] `ADMIN_SETUP_KEY=<generated-key>`

#### Master User (Recommended)

- [ ] `MASTER_USER_EMAIL`
- [ ] `MASTER_USER_PASSWORD`
- [ ] `MASTER_USER_FIRST_NAME`
- [ ] `MASTER_USER_LAST_NAME`
- [ ] `MASTER_USER_ORGANIZATION`

#### Optional Services

- [ ] Email: `RESEND_API_KEY`, `FROM_EMAIL`
- [ ] Stripe: `STRIPE_SECRET_KEY`, `STRIPE_PUBLISHABLE_KEY`
- [ ] AI: `OPENAI_API_KEY`, `ANTHROPIC_API_KEY`
- [ ] Shopify: `SHOPIFY_*` variables (if applicable)
- [ ] S3: `AWS_*` variables (if using S3 storage)

---

## Initial Deployment

### Trigger Deployment

- [ ] Code pushed to main branch triggers deployment
- [ ] Build started in Railway dashboard
- [ ] Build completed successfully (check logs)
- [ ] Health checks passing
- [ ] Deployment status shows "Active"

### Deployment Monitoring

- [ ] Watched deployment in real-time
- [ ] No errors in build logs
- [ ] No errors in application logs
- [ ] Public URL generated by Railway

---

## Database Initialization

### Schema Setup

- [ ] Connected to Railway shell
- [ ] Ran: `npm run db:push`
- [ ] All tables created (90+ tables)
- [ ] No migration errors
- [ ] Master user created automatically (if configured)

### Verification

- [ ] Database connection test passed
- [ ] Health endpoint shows: `"database": "connected"`
- [ ] Can query tables without errors

---

## Application Verification

### Health Checks

- [ ] `/api/health` returns 200 OK
- [ ] Response shows:
  - [ ] `"status": "ok"`
  - [ ] `"database": "connected"`
  - [ ] `"redis": "connected"`
  - [ ] Valid timestamp

### Frontend Tests

- [ ] Homepage loads correctly
- [ ] Static assets loading (CSS, JS, images)
- [ ] No console errors in browser
- [ ] Login page displays
- [ ] Registration page displays

### API Tests

- [ ] `/api/health` - responds
- [ ] `/api/auth/session` - responds
- [ ] `/api/companies` - requires auth (401)
- [ ] CORS headers present
- [ ] Security headers present

### Authentication Tests

- [ ] Master user can log in
- [ ] Login redirects to dashboard
- [ ] Session persists on refresh
- [ ] Logout works correctly
- [ ] New user registration works (if enabled)

---

## Security Verification

### HTTPS/SSL

- [ ] Railway provides automatic HTTPS
- [ ] SSL certificate valid (green padlock)
- [ ] HTTP redirects to HTTPS
- [ ] Certificate auto-renews

### Security Headers

Check with:
```bash
curl -I https://your-app.railway.app | grep -i "x-\|strict\|content-security"
```

- [ ] `Strict-Transport-Security` present
- [ ] `X-Frame-Options` present
- [ ] `X-Content-Type-Options` present
- [ ] `X-XSS-Protection` present (or CSP)
- [ ] `Content-Security-Policy` present

### Environment Security

- [ ] Secrets not committed to Git
- [ ] `.env` in `.gitignore`
- [ ] Railway variables encrypted
- [ ] Database password strong
- [ ] Redis password configured (if applicable)

---

## Performance & Monitoring

### Performance Tests

- [ ] Homepage loads < 3 seconds
- [ ] API response time < 500ms
- [ ] Static assets load quickly
- [ ] No memory leaks observed

### Monitoring Setup

- [ ] Railway metrics dashboard working
- [ ] Application logs visible
- [ ] Error tracking configured (Sentry, if using)
- [ ] Uptime monitoring configured (optional)

### Resource Limits

- [ ] CPU usage < 70% under normal load
- [ ] Memory usage < 80%
- [ ] No disk space warnings
- [ ] Database connections < max limit

---

## Post-Deployment

### Smoke Tests

- [ ] Run: `./scripts/production-readiness/smoke-tests.sh https://your-app.railway.app`
- [ ] All tests passing
- [ ] No critical issues found

### User Acceptance

- [ ] Team can access application
- [ ] All roles working (ECP, Lab Tech, etc.)
- [ ] Critical workflows tested:
  - [ ] Create patient
  - [ ] Create order
  - [ ] View dashboard
  - [ ] Generate report

### Documentation

- [ ] Deployment documented
- [ ] Public URL shared with team
- [ ] Login credentials shared securely
- [ ] Known issues documented (if any)

---

## Optional: Custom Domain

### DNS Configuration

- [ ] Domain purchased/available
- [ ] DNS records added:
  - [ ] CNAME record: `app` → `<your-app>.railway.app`
  - [ ] TTL set to 300 (5 minutes)
- [ ] DNS propagated (check with `dig` or `nslookup`)

### Railway Configuration

- [ ] Custom domain added in Railway
- [ ] SSL certificate provisioned
- [ ] Domain accessible via HTTPS
- [ ] Old domain redirects (if applicable)

---

## Backup & Recovery

### Backup Configuration

- [ ] Railway automatic backups enabled
- [ ] Backup frequency confirmed (daily)
- [ ] Backup retention confirmed (7/30 days)
- [ ] Manual backup tested: `railway run npm run backup`

### Recovery Plan

- [ ] Rollback procedure documented
- [ ] Database restore tested (optional but recommended)
- [ ] Team knows how to rollback
- [ ] Emergency contacts documented

---

## Team Onboarding

### Access Control

- [ ] Team members invited to Railway project
- [ ] Roles assigned (admin, developer, viewer)
- [ ] Application users created
- [ ] Permissions tested

### Training

- [ ] Team trained on Railway dashboard
- [ ] Deployment process documented
- [ ] Monitoring procedures shared
- [ ] Support contacts provided

---

## Final Verification

### Production Readiness

- [ ] All checklist items completed
- [ ] No critical issues outstanding
- [ ] Performance acceptable
- [ ] Security verified
- [ ] Team has access
- [ ] Documentation complete

### Sign-Off

- [ ] Product owner approves
- [ ] Technical lead approves
- [ ] Security review passed (if required)
- [ ] Compliance verified (if required)

---

## Post-Launch (First 24 Hours)

### Monitoring

- [ ] Check logs every 2 hours
- [ ] Monitor error rates
- [ ] Track performance metrics
- [ ] Watch resource usage

### User Feedback

- [ ] Collect user feedback
- [ ] Address critical issues immediately
- [ ] Document known issues
- [ ] Plan fixes for next deployment

### Optimization

- [ ] Identify slow queries
- [ ] Optimize if needed
- [ ] Adjust resources if needed
- [ ] Review and tune caching

---

## Success Criteria

**Deployment is successful when:**

✅ Application accessible at public URL
✅ All health checks passing
✅ Master user can log in
✅ Critical workflows work
✅ No errors in logs
✅ Performance acceptable
✅ Security verified
✅ Team has access
✅ Monitoring active
✅ Backups configured

---

## Rollback Criteria

**Rollback immediately if:**

❌ Error rate > 5%
❌ Database corruption detected
❌ Security vulnerability discovered
❌ Critical feature broken
❌ Performance degraded > 50%
❌ Data loss detected

---

## Support Resources

- **Railway Guide**: [./RAILWAY_DEPLOYMENT_GUIDE.md](./RAILWAY_DEPLOYMENT_GUIDE.md)
- **Quick Start**: [./RAILWAY_QUICK_START.md](./RAILWAY_QUICK_START.md)
- **Platform Docs**: [./README.md](./README.md)
- **Railway Docs**: [docs.railway.app](https://docs.railway.app)
- **Railway Support**: Discord or support@railway.app

---

**Deployment Date**: _______________
**Deployed By**: _______________
**Railway Project ID**: _______________
**Production URL**: _______________

**Status**: [ ] Successful  [ ] Failed  [ ] Rolled Back

**Notes**:
```






```

---

**Last Updated**: November 2025
**Version**: 1.0
